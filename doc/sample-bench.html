<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
    <title>dynatree - benchmarks</title>
    <!-- Include the required JavaScript libraries: -->
    <script src='../jquery/jquery.js' type='text/javascript'></script>
    <script src='../jquery/ui.core.js' type='text/javascript'></script>

    <link rel='stylesheet' type='text/css' href='../src/skin/ui.dynatree.css' />
	<script src='../src/jquery.dynatree.js' type='text/javascript'></script>

    <!-- Add code to initialize the tree when the document is loaded: -->
    <script type='text/javascript'>
    $(function(){
		$("#tree").dynatree({
			children: [
				{title: "Add 100 nodes (flat)...", isFolder: true, isLazy: true, mode: "add100_flat" },
				{title: "Add 100 nodes (flat, with permanent update)...", isFolder: true, isLazy: true, mode: "add100_flat_update" },
				{title: "Add 1.000 nodes (flat)...", isFolder: true, isLazy: true, mode: "add1000_flat" },
				{title: "Add 1.000 nodes (deep)...", isFolder: true, isLazy: true, mode: "add1000_deep" },
				{title: "Add 10.000 nodes (deep)...", isFolder: true, isLazy: true, mode: "add10000_deep" },
			],
			onSelect: function(dtnode) {
				alert("You selected " + dtnode.data.title);
			},
			onLazyRead: function(dtnode) {
				var tree = dtnode.tree;
				logMsg("Benchmarking mode='" + dtnode.data.mode + "'...");
				switch( dtnode.data.mode ) {
					case "add100_flat_update":
						addNodes(dtnode, 100, 0, 0)
						break;
					case "add100_flat":
						tree.enableUpdate (false);
						addNodes(dtnode, 100, 0, 0)
						tree.enableUpdate (true);
						break;
					case "add1000_flat":
						tree.enableUpdate (false);
						addNodes(dtnode, 1000, 0, 0)
						tree.enableUpdate (true);
						break;
					case "add1000_deep":
						tree.enableUpdate (false);
						addNodes(dtnode, 10, 10, 10)
						tree.enableUpdate (true);
						break;
					case "add10000_deep":
						tree.enableUpdate (false);
						addNodes(dtnode, 10, 100, 10)
						tree.enableUpdate (true);
						break;
				}
				dtnode.setLazyNodeStatus(DTNodeStatus_Ok);
				logMsg("Benchmarking mode='" + dtnode.data.mode + "' done.");
			}
		});
	});

	function addNodes(dtnode, level1, level2, level3) {
		var key;
		for (var i=0; i<level1; i++) {
			key = "" + (i+1);
			var f = dtnode.append({title: "Folder_" + key,
			                       key: key,
				                   isFolder: true
								   });
			for (var j=0; j<level2; j++) {
				key = "" + (i+1) + "." + (j+1);
				var d = f.append({title: "Node_" + key,
				                  key: key
							      });
				for (var k=0; k<level3; k++) {
					key = "" + (i+1) + "." + (j+1) + "." + (k+1);
					d.append({title: "Node_" + key,
					          key: key
						      });
				}
			}
		}
	}

    </script>
</head>
<body>
	<P>Expand a node to start a benchmark, then check the firebug console.</P>
	<div id='tree'> </div>
	enableUpdate(false) is used for speedup.</p>
	<p><a href="http://dynatree.googlecode.com">jquery.dynatree.js</a></p>
</body>
</html>
